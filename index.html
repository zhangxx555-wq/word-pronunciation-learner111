<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•è¯å‘éŸ³å­¦ä¹ å™¨ - ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆ</title>
    
    <style>
        /* åŸºç¡€æ ·å¼ - ä¿æŒæ‚¨åŸæœ‰çš„CSSå®Œå…¨ä¸å˜ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 15px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .input-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
            font-weight: bold;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin: 5px 0;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn-success {
            background: #2ecc71;
        }
        
        .btn-success:hover {
            background: #27ae60;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-test {
            background: #9b59b6;
        }
        
        .btn-test:hover {
            background: #8e44ad;
        }
        
        .btn-import {
            background: #FF9800;
        }
        
        .btn-backup {
            background: #9C27B0;
        }
        
        .table-section {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        .table-header {
            background: #2c3e50;
            color: white;
            padding: 15px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: #ecf0f1;
        }
        
        th {
            padding: 12px;
            text-align: left;
            color: #2c3e50;
            font-weight: bold;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .word-cell {
            color: #3498db;
            cursor: pointer;
            font-weight: bold;
        }
        
        .word-cell:hover {
            text-decoration: underline;
        }
        
        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            margin: 0 5px;
        }
        
        .play-btn {
            color: #3498db;
        }
        
        .slow-btn {
            color: #e74c3c;
        }
        
        .delete-btn {
            color: #95a5a6;
        }
        
        .status-bar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #2ecc71;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            display: none;
            z-index: 1000;
        }
        
        .empty-table {
            text-align: center;
            padding: 40px;
            color: #95a5a6;
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading-spinner i {
            font-size: 24px;
            color: #3498db;
        }
        
        /* ç®€å•åŠ è½½åŠ¨ç”» */
        .simple-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    
    <!-- åŠ è½½Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- ç®€å•åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div id="simpleLoader" class="simple-spinner" style="display: none;"></div>
    
    <div class="container" id="mainContent">
        <header>
            <h1><i class="fas fa-volume-up"></i> å•è¯å‘éŸ³å­¦ä¹ å™¨</h1>
            <p class="subtitle">è¾“å…¥å•è¯ â†’ ç‚¹å‡»å‘éŸ³ â†’ å®æ—¶å­¦ä¹ </p>
        </header>
        
        <div class="main-content">
            <!-- å·¦ä¾§ï¼šè¾“å…¥åŒºåŸŸ -->
            <div class="input-section">
                <h2><i class="fas fa-plus-circle"></i> æ·»åŠ æ–°å•è¯</h2>
                
                <div class="input-group">
                    <label for="wordInput"><i class="fas fa-font"></i> å•è¯/å¥å­</label>
                    <input type="text" id="wordInput" placeholder="è¾“å…¥ä½ æƒ³å­¦ä¹ çš„å•è¯æˆ–å¥å­">
                </div>
                
                <div class="input-group">
                    <label for="phoneticInput"><i class="fas fa-music"></i> éŸ³æ ‡ï¼ˆå¯é€‰ï¼‰</label>
                    <input type="text" id="phoneticInput" placeholder="ä¾‹å¦‚: /ËˆÃ¦pl/">
                </div>
                
                <div class="input-group">
                    <label for="meaningInput"><i class="fas fa-language"></i> é‡Šä¹‰ï¼ˆå¯é€‰ï¼‰</label>
                    <input type="text" id="meaningInput" placeholder="ä¾‹å¦‚: è‹¹æœ">
                </div>
                
                <div class="input-group">
                    <label for="languageSelect"><i class="fas fa-globe"></i> é€‰æ‹©è¯­è¨€</label>
                    <select id="languageSelect">
                        <option value="en-US">è‹±è¯­ (ç¾å¼)</option>
                        <option value="zh-CN">ä¸­æ–‡ (æ™®é€šè¯)</option>
                        <option value="ja-JP">æ—¥è¯­</option>
                        <option value="ko-KR">éŸ©è¯­</option>
                        <option value="fr-FR">æ³•è¯­</option>
                        <option value="de-DE">å¾·è¯­</option>
                    </select>
                </div>
                
                <button class="btn btn-success" onclick="addWord()">
                    <i class="fas fa-plus"></i> æ·»åŠ åˆ°å•è¯è¡¨
                </button>
                
                <button class="btn btn-test" onclick="testPronunciation()">
                    <i class="fas fa-play"></i> è¯•å¬å‘éŸ³
                </button>
                
                <button class="btn btn-danger" onclick="clearAllWords()">
                    <i class="fas fa-trash"></i> æ¸…ç©ºæ‰€æœ‰å•è¯
                </button>
                
                <button class="btn btn-import" onclick="importWordData()">
                    <i class="fas fa-file-import"></i> å¯¼å…¥æ•°æ®
                </button>
                
                <button class="btn btn-backup" onclick="backupData()">
                    <i class="fas fa-download"></i> å¤‡ä»½æ•°æ®
                </button>
            </div>
            
            <!-- å³ä¾§ï¼šå•è¯è¡¨æ ¼ -->
            <div class="table-section">
                <div class="table-header">
                    <h2><i class="fas fa-list"></i> å•è¯è¡¨ (<span id="wordCount">0</span>ä¸ªå•è¯)</h2>
                </div>
                
                <div style="overflow-x: auto;">
                    <table id="wordTable">
                        <thead>
                            <tr>
                                <th>å•è¯</th>
                                <th>éŸ³æ ‡</th>
                                <th>é‡Šä¹‰</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="wordList">
                            <!-- å•è¯ä¼šåŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                        </tbody>
                    </table>
                    
                    <div id="emptyMessage" class="empty-table">
                        <i class="fas fa-book-open"></i>
                        <h3>å•è¯è¡¨æ˜¯ç©ºçš„</h3>
                        <p>è¯·åœ¨å·¦ä¾§æ·»åŠ ä½ çš„ç¬¬ä¸€ä¸ªå•è¯</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="status-bar" id="statusBar"></div>

    <script>
        // ==================== æ ¸å¿ƒå˜é‡ ====================
        let wordList = [];
        const STORAGE_KEY = 'simple_word_learner';
        
        // å‘éŸ³ä¼˜åŒ–æ–°å¢å˜é‡
        let availableVoices = [];
        let currentVoice = null;
        let isVoiceSystemReady = false;
        
        // ==================== é¡µé¢åˆå§‹åŒ– ====================
        window.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢å¼€å§‹åŠ è½½');
            
            // ç«‹å³æ˜¾ç¤ºä¸»å†…å®¹
            document.getElementById('mainContent').style.display = 'block';
            
            // åŠ è½½å•è¯æ•°æ®
            loadWordsFromStorage();
            
            // åˆå§‹åŒ–è¯­éŸ³ç³»ç»Ÿï¼ˆæ–°å¢ï¼‰
            initVoiceSystem();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            setTimeout(function() {
                showStatus('é¡µé¢åŠ è½½å®Œæˆï¼', 'success');
            }, 500);
            
            console.log('é¡µé¢åŠ è½½å®Œæˆ');
        });
        
        // ==================== æ–°å¢ï¼šè¯­éŸ³ç³»ç»Ÿä¼˜åŒ– ====================
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ');
                return;
            }
            
            // è·å–å¯ç”¨çš„è¯­éŸ³
            function loadAvailableVoices() {
                availableVoices = speechSynthesis.getVoices();
                
                if (availableVoices.length > 0) {
                    selectBestVoice();
                    isVoiceSystemReady = true;
                    console.log('è¯­éŸ³ç³»ç»Ÿå°±ç»ªï¼Œæ‰¾åˆ°', availableVoices.length, 'ä¸ªè¯­éŸ³');
                }
            }
            
            // åŠ è½½è¯­éŸ³
            loadAvailableVoices();
            
            // ç›‘å¬è¯­éŸ³å˜åŒ–ï¼ˆæœ‰äº›æµè§ˆå™¨éœ€è¦è¿™ä¸ªï¼‰
            speechSynthesis.onvoiceschanged = loadAvailableVoices;
        }
        
        function selectBestVoice() {
            if (availableVoices.length === 0) return;
            
            const targetLang = document.getElementById('languageSelect').value;
            let bestVoice = null;
            let bestScore = -1;
            
            // ä¸ºæ¯ä¸ªè¯­éŸ³è¯„åˆ†
            availableVoices.forEach(voice => {
                let score = 0;
                
                // 1. è¯­è¨€åŒ¹é…ï¼ˆæœ€é‡è¦ï¼‰
                if (voice.lang === targetLang) {
                    score += 100; // å®Œå…¨åŒ¹é…
                } else if (voice.lang.startsWith(targetLang.substring(0, 2))) {
                    score += 50; // è¯­è¨€ç›¸åŒï¼Œåœ°åŒºä¸åŒ
                }
                
                // 2. è¯­éŸ³è´¨é‡åˆ¤æ–­
                const voiceName = voice.name.toLowerCase();
                if (voiceName.includes('natural') || voiceName.includes('premium')) {
                    score += 30; // é«˜è´¨é‡è¯­éŸ³
                } else if (voiceName.includes('enhanced')) {
                    score += 20; // å¢å¼ºç‰ˆ
                } else if (voiceName.includes('google')) {
                    score += 15; // Googleè¯­éŸ³
                }
                
                // 3. æœ¬åœ°è¯­éŸ³æ›´ç¨³å®š
                if (voice.localService) {
                    score += 10;
                }
                
                // 4. å·²çŸ¥çš„å¥½è¯­éŸ³åŠ åˆ†
                if (voiceName.includes('microsoft david') || 
                    voiceName.includes('microsoft zira') ||
                    voiceName.includes('samantha') ||
                    voiceName.includes('daniel')) {
                    score += 5;
                }
                
                // æ›´æ–°æœ€ä½³è¯­éŸ³
                if (score > bestScore) {
                    bestScore = score;
                    bestVoice = voice;
                }
            });
            
            currentVoice = bestVoice || availableVoices[0];
            
            if (currentVoice) {
                console.log('é€‰æ‹©è¯­éŸ³:', currentVoice.name, 'è¯­è¨€:', currentVoice.lang);
            }
        }
        
        // ==================== ä¼˜åŒ–ç‰ˆå‘éŸ³å‡½æ•° ====================
        function speakWord(text, lang = 'en-US') {
            if (!('speechSynthesis' in window)) {
                showStatus('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ', 'error');
                return;
            }
            
            // éªŒè¯è¾“å…¥
            if (!text || text.trim() === '') {
                showStatus('è¯·è¾“å…¥è¦å‘éŸ³çš„æ–‡æœ¬', 'error');
                return;
            }
            
            // æ¸…ç†æ–‡æœ¬
            text = text.trim();
            
            // åœæ­¢å½“å‰å‘éŸ³
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            // åˆ›å»ºè¯­éŸ³å®ä¾‹
            const utterance = new SpeechSynthesisUtterance(text);
            
            // è®¾ç½®è¯­éŸ³ï¼ˆä¼˜åŒ–éƒ¨åˆ†ï¼‰
            if (currentVoice && isVoiceSystemReady) {
                utterance.voice = currentVoice;
                utterance.lang = currentVoice.lang;
            } else {
                utterance.lang = lang;
            }
            
            // ä¼˜åŒ–å‘éŸ³å‚æ•°ï¼ˆæ ¹æ®è¯­è¨€è°ƒæ•´ï¼‰
            const langSettings = {
                'en-US': { rate: 0.85, pitch: 1.0, volume: 1.0 },
                'en-GB': { rate: 0.88, pitch: 1.0, volume: 1.0 },
                'zh-CN': { rate: 0.75, pitch: 1.1, volume: 1.0 },
                'ja-JP': { rate: 0.78, pitch: 1.0, volume: 1.0 },
                'fr-FR': { rate: 0.9, pitch: 0.95, volume: 1.0 },
                'de-DE': { rate: 0.85, pitch: 1.0, volume: 1.0 },
                'ko-KR': { rate: 0.8, pitch: 1.0, volume: 1.0 }
            };
            
            const settings = langSettings[lang] || { rate: 0.85, pitch: 1.0, volume: 1.0 };
            utterance.rate = settings.rate;    // è¯­é€Ÿï¼š0.1ï¼ˆå¾ˆæ…¢ï¼‰-10ï¼ˆå¾ˆå¿«ï¼‰
            utterance.pitch = settings.pitch;  // éŸ³è°ƒï¼š0ï¼ˆä½ï¼‰-2ï¼ˆé«˜ï¼‰
            utterance.volume = settings.volume;// éŸ³é‡ï¼š0-1
            
            // äº‹ä»¶å¤„ç†
            utterance.onstart = function() {
                showStatus('ğŸ”Š å‘éŸ³ä¸­...', 'info');
            };
            
            utterance.onend = function() {
                showStatus('å‘éŸ³å®Œæˆ', 'success');
            };
            
            utterance.onerror = function(event) {
                console.error('å‘éŸ³é”™è¯¯:', event);
                showStatus('å‘éŸ³å‡ºé”™', 'error');
                
                // å°è¯•å¤‡é€‰æ–¹æ¡ˆï¼šä½¿ç”¨ç®€å•è®¾ç½®
                try {
                    const fallbackUtterance = new SpeechSynthesisUtterance(text);
                    fallbackUtterance.lang = lang;
                    fallbackUtterance.rate = 0.8;
                    fallbackUtterance.pitch = 1.0;
                    speechSynthesis.speak(fallbackUtterance);
                } catch (e) {
                    console.error('å¤‡é€‰æ–¹æ¡ˆä¹Ÿå¤±è´¥äº†:', e);
                }
            };
            
            // å»¶è¿Ÿæ’­æ”¾ç¡®ä¿ç¨³å®šæ€§
            setTimeout(() => {
                speechSynthesis.speak(utterance);
            }, 50);
        }
        
        // æ…¢é€Ÿå‘éŸ³
        function speakSlow(text, lang = 'en-US') {
            if (!('speechSynthesis' in window)) return;
            
            const utterance = new SpeechSynthesisUtterance(text);
            
            if (currentVoice && isVoiceSystemReady) {
                utterance.voice = currentVoice;
                utterance.lang = currentVoice.lang;
            } else {
                utterance.lang = lang;
            }
            
            utterance.rate = 0.6;  // æ›´æ…¢çš„è¯­é€Ÿ
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            speechSynthesis.speak(utterance);
            showStatus('æ…¢é€Ÿå‘éŸ³...', 'info');
        }
        
        // ==================== æ‚¨çš„åŸæœ‰åŠŸèƒ½ï¼ˆä¿æŒå®Œå…¨ä¸å˜ï¼‰====================
        
        // æ·»åŠ å•è¯
        function addWord() {
            const wordInput = document.getElementById('wordInput');
            const phoneticInput = document.getElementById('phoneticInput');
            const meaningInput = document.getElementById('meaningInput');
            const languageSelect = document.getElementById('languageSelect');
            
            const word = wordInput.value.trim();
            const phonetic = phoneticInput.value.trim();
            const meaning = meaningInput.value.trim();
            const language = languageSelect.value;
            
            if (!word) {
                showStatus('è¯·è¾“å…¥å•è¯ï¼', 'error');
                return;
            }
            
            // åˆ›å»ºæ–°å•è¯
            const newWord = {
                id: Date.now(),
                word: word,
                phonetic: phonetic || 'â€”',
                meaning: meaning || 'â€”',
                language: language,
                date: new Date().toLocaleDateString()
            };
            
            wordList.push(newWord);
            renderTable();
            
            // æ¸…ç©ºè¾“å…¥
            wordInput.value = '';
            phoneticInput.value = '';
            meaningInput.value = '';
            wordInput.focus();
            
            showStatus('å•è¯å·²æ·»åŠ ï¼', 'success');
            saveWordsToStorage();
        }
        
        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const tbody = document.getElementById('wordList');
            const emptyMessage = document.getElementById('emptyMessage');
            
            if (wordList.length === 0) {
                tbody.innerHTML = '';
                emptyMessage.style.display = 'block';
                updateWordCount();
                return;
            }
            
            emptyMessage.style.display = 'none';
            tbody.innerHTML = '';
            
            wordList.forEach((item) => {
                const row = document.createElement('tr');
                
                // å•è¯åˆ— - ä½¿ç”¨ä¼˜åŒ–åçš„speakWord
                const wordCell = document.createElement('td');
                wordCell.innerHTML = `
                    <div class="word-cell" onclick="speakWord('${escapeText(item.word)}', '${item.language}')">
                        <i class="fas fa-volume-up"></i> ${item.word}
                    </div>
                    <div style="font-size: 12px; color: #95a5a6;">
                        ${item.language} | ${item.date}
                    </div>
                `;
                
                // éŸ³æ ‡åˆ—
                const phoneticCell = document.createElement('td');
                phoneticCell.textContent = item.phonetic;
                
                // é‡Šä¹‰åˆ—
                const meaningCell = document.createElement('td');
                meaningCell.textContent = item.meaning;
                
                // æ“ä½œåˆ— - ä½¿ç”¨ä¼˜åŒ–åçš„speakWord
                const actionCell = document.createElement('td');
                actionCell.innerHTML = `
                    <button class="action-btn play-btn" onclick="speakWord('${escapeText(item.word)}', '${item.language}')" title="å‘éŸ³">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="action-btn delete-btn" onclick="deleteWord(${item.id})" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                
                row.appendChild(wordCell);
                row.appendChild(phoneticCell);
                row.appendChild(meaningCell);
                row.appendChild(actionCell);
                tbody.appendChild(row);
            });
            
            updateWordCount();
        }
        
        // è½¬ä¹‰æ–‡æœ¬ï¼Œé˜²æ­¢å¼•å·é—®é¢˜
        function escapeText(text) {
            return text.replace(/'/g, "\\'").replace(/"/g, '&quot;');
        }
        
        // è¯•å¬å‘éŸ³ - ä½¿ç”¨ä¼˜åŒ–åçš„å‡½æ•°
        function testPronunciation() {
            const wordInput = document.getElementById('wordInput');
            const languageSelect = document.getElementById('languageSelect');
            
            const text = wordInput.value.trim();
            if (!text) {
                showStatus('è¯·è¾“å…¥è¦è¯•å¬çš„å•è¯', 'error');
                return;
            }
            
            speakWord(text, languageSelect.value);
        }
        
        // åˆ é™¤å•è¯
        function deleteWord(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå•è¯å—ï¼Ÿ')) {
                wordList = wordList.filter(item => item.id !== id);
                renderTable();
                saveWordsToStorage();
                showStatus('å•è¯å·²åˆ é™¤', 'info');
            }
        }
        
        // æ¸…ç©ºæ‰€æœ‰å•è¯
        function clearAllWords() {
            if (wordList.length === 0) {
                showStatus('å•è¯è¡¨å·²ç»æ˜¯ç©ºçš„', 'info');
                return;
            }
            
            if (confirm(`ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ ${wordList.length} ä¸ªå•è¯å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)) {
                wordList = [];
                renderTable();
                saveWordsToStorage();
                showStatus('å·²æ¸…ç©ºæ‰€æœ‰å•è¯', 'info');
            }
        }
        
        // ==================== æ•°æ®å­˜å‚¨ ====================
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveWordsToStorage() {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(wordList));
            } catch (error) {
                console.error('ä¿å­˜å¤±è´¥:', error);
            }
        }
        
        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½
        function loadWordsFromStorage() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    wordList = JSON.parse(savedData);
                    renderTable();
                }
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                wordList = [];
            }
        }
        
        // æ›´æ–°å•è¯è®¡æ•°
        function updateWordCount() {
            document.getElementById('wordCount').textContent = wordList.length;
        }
        
        // ==================== å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ ====================
        
        // å¯¼å‡ºæ•°æ®
        function exportWords() {
            if (wordList.length === 0) {
                showStatus('æ²¡æœ‰å•è¯å¯ä»¥å¯¼å‡º', 'error');
                return;
            }
            
            const data = {
                exportedAt: new Date().toISOString(),
                words: wordList
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'æˆ‘çš„å•è¯è¡¨.json';
            a.click();
            
            showStatus('æ•°æ®å·²å¯¼å‡º', 'success');
        }
        
        // å¯¼å…¥æ•°æ®
        function importWordData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        let importedWords = [];
                        
                        if (Array.isArray(importedData)) {
                            importedWords = importedData;
                        } else if (importedData.words && Array.isArray(importedData.words)) {
                            importedWords = importedData.words;
                        }
                        
                        if (importedWords.length === 0) {
                            throw new Error('æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„å•è¯æ•°æ®');
                        }
                        
                        // åˆå¹¶æ•°æ®
                        const existingWords = new Set(wordList.map(w => w.word.toLowerCase()));
                        const newWords = importedWords.filter(w => 
                            w.word && !existingWords.has(w.word.toLowerCase())
                        );
                        
                        wordList = wordList.concat(newWords);
                        saveWordsToStorage();
                        renderTable();
                        
                        showStatus(`æˆåŠŸå¯¼å…¥ ${newWords.length} ä¸ªå•è¯`, 'success');
                        
                    } catch (error) {
                        showStatus('å¯¼å…¥å¤±è´¥: ' + error.message, 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // å¤‡ä»½æ•°æ®
        function backupData() {
            if (wordList.length === 0) {
                showStatus('æ²¡æœ‰æ•°æ®å¯ä»¥å¤‡ä»½', 'error');
                return;
            }
            
            const backup = {
                version: '1.0',
                backupAt: new Date().toISOString(),
                wordCount: wordList.length,
                words: wordList
            };
            
            const dataStr = JSON.stringify(backup, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'å•è¯å¤‡ä»½.json';
            a.click();
            
            showStatus('æ•°æ®å·²å¤‡ä»½', 'success');
        }
        
        // ==================== å·¥å…·å‡½æ•° ====================
        
        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(message, type = 'info') {
            const statusBar = document.getElementById('statusBar');
            
            statusBar.textContent = message;
            statusBar.style.display = 'block';
            
            // è®¾ç½®é¢œè‰²
            const colors = {
                success: '#2ecc71',
                error: '#e74c3c',
                info: '#3498db'
            };
            statusBar.style.background = colors[type] || colors.info;
            
            // 3ç§’åéšè—
            setTimeout(() => {
                statusBar.style.display = 'none';
            }, 3000);
        }
        
        // ==================== é”®ç›˜å¿«æ·é”® ====================
        
        document.addEventListener('keydown', function(e) {
            const wordInput = document.getElementById('wordInput');
            
            // ç„¦ç‚¹åœ¨è¾“å…¥æ¡†æ—¶
            if (document.activeElement === wordInput) {
                // Enter é”®è¯•å¬å‘éŸ³
                if (e.key === 'Enter') {
                    testPronunciation();
                    e.preventDefault();
                }
                
                // Ctrl+Enter æ·»åŠ å•è¯
                if (e.ctrlKey && e.key === 'Enter') {
                    addWord();
                    e.preventDefault();
                }
            }
            
            // ç©ºæ ¼é”®åœæ­¢å‘éŸ³
            if (e.key === ' ' && !e.target.matches('input, textarea, button')) {
                if (speechSynthesis.speaking) {
                    speechSynthesis.cancel();
                    showStatus('å‘éŸ³å·²åœæ­¢', 'info');
                }
                e.preventDefault();
            }
        });
        
        // åˆå§‹ç¤ºä¾‹æ•°æ®
        function addExampleWords() {
            const examples = [
                { word: 'Hello', phonetic: '/hÉ™ËˆlÉ™ÊŠ/', meaning: 'ä½ å¥½', language: 'en-US' },
                { word: 'Pronunciation', phonetic: '/prÉ™ËŒnÊŒn.siËˆeÉª.ÊƒÉ™n/', meaning: 'å‘éŸ³', language: 'en-US' },
                { word: 'ä½ å¥½', phonetic: 'nÇ hÇo', meaning: 'Hello', language: 'zh-CN' },
                { word: 'ã“ã‚“ã«ã¡ã¯', phonetic: 'konnichiwa', meaning: 'ä½ å¥½', language: 'ja-JP' }
            ];
            
            examples.forEach(example => {
                wordList.push({
                    id: Date.now() + Math.random(),
                    ...example,
                    date: new Date().toLocaleDateString()
                });
            });
            
            renderTable();
            saveWordsToStorage();
            showStatus('å·²æ·»åŠ ç¤ºä¾‹å•è¯', 'success');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ·»åŠ ä¸€äº›ç¤ºä¾‹å•è¯ï¼ˆå¦‚æœä¸ºç©ºï¼‰
        setTimeout(function() {
            if (wordList.length === 0) {
                // å¯é€‰ï¼šè‡ªåŠ¨æ·»åŠ ç¤ºä¾‹å•è¯
                // addExampleWords();
            }
        }, 1000);
    </script>
</body>
</html>